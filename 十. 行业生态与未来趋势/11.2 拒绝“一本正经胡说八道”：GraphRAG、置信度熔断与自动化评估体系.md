# 11.2 拒绝“一本正经胡说八道”：GraphRAG、置信度熔断与自动化评估体系

> **摘要**：医疗场景的容错率趋近于零。如果 AI 无法做到 100% 准确，至少要做到“知之为知之，不知为不知”。本文将构建一套三层防御体系：**事前**用 GraphRAG 增强逻辑链，**事中**用置信度熔断机制实时拦截，**事后**用自动化评估体系持续监控。

---

## 第一层防御：事前增强——GraphRAG 的逻辑链

传统的 RAG（检索增强）是“碎片化”的，容易断章取义。比如问“吃药 A 能吃药 B 吗？”，传统 RAG 搜不到直接冲突就敢说“没问题”。
而 **GraphRAG（知识图谱检索增强）** 给模型装上了“医学大脑”。

### 1. 从文本到图谱
*   **构建过程**：利用 LLM 抽取实体（Entity）和关系（Relation），构建知识图谱。如 `阿司匹林 --[抑制]--> 血小板`。
*   **多跳推理（Multi-hop Reasoning）**：当用户问药物相互作用时，系统在图谱上进行多跳遍历，发现隐式冲突路径，从而避免“只见树木不见森林”。

### 2. 双路召回（Hybrid RAG）
*   **非结构化描述**（如“胸口像压大石头”）：走**向量检索**，捕捉模糊语义。
*   **精确药理机制**：走**图谱检索**，确保逻辑严密。
两者结合，既有灵活性又有严谨性。

---

## 第二层防御：事中拦截——置信度熔断与拒答机制

模型即使有了 RAG，也可能因“过度自信”而胡编乱造。我们需要一套实时的“刹车系统”。

### 1. 基于 Logits 的熔断
*   **困惑度（PPL）**：如果模型生成一段话时 PPL 飙升，说明它自己在犹豫，系统应直接拦截。
*   **语义熵（Semantic Entropy）**：让模型对同一问题回答 5 次。如果答案南辕北辙（有的说癌，有的说炎），说明它在瞎猜，必须触发拒答。

### 2. 共形预测（Conformal Prediction）
*   统计学上的魔法。不给单一答案，而是给出一个包含正确答案概率为 95% 的“候选集合”。如果集合里同时包含“感冒”和“肺癌”，说明不确定性极大，强制转人工。

---

## 第三层防御：事后监控——LLM-as-a-Judge

模型上线后，如何知道它表现好不好？靠医生每天人肉抽检是不现实的。

### 1. 自动化评估体系
*   **专用裁判模型**：使用微调过的 Prometheus 或 Auto-J 模型作为裁判，专门给业务模型的回答打分。
*   **无参考评估（Reference-Free）**：在没有标准答案的情况下，裁判模型根据医学知识库和逻辑自洽性直接打分，解决 Ground Truth 缺失难题。

### 2. 黄金三角指标
*   **忠实度（Faithfulness）**：回答是否忠实于检索到的文档？（查幻觉）
*   **相关性（Relevance）**：是否答非所问？
*   **安全性（Harmlessness）**：是否包含高风险建议？

---

## 结语

一个成熟的医疗 AI 系统，不仅要比谁更聪明（Recall 高），更要比谁更谨慎（Precision 高）。
通过 **GraphRAG（懂逻辑） + 置信度熔断（敢闭嘴） + 自动化评估（有监督）**，我们为 AI 医生穿上了一套防弹衣，让它在复杂的临床环境中安全着陆。
