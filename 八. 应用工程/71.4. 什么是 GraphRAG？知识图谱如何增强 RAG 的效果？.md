# 75. 什么是 GraphRAG？知识图谱如何增强 RAG 的效果？

当 RAG 还在“大海捞针”（检索片段）时，**GraphRAG** 已经开始“绘制航海图”（构建关系）了。

传统的 RAG（我们称之为 **Baseline RAG**）有一个致命弱点：**它擅长回答“是什么”，但不擅长回答“怎么样”和“全貌如何”。**
比如你问：“这篇文章的主旨是什么？”或者“A 和 B 有什么隐秘的联系？”，Baseline RAG 往往会抓瞎。

---

## 1. 传统 RAG 的“碎片化”困境

想象你在读一本侦探小说。

- **传统 RAG**：像是把书撕碎了，只给你看含有“凶手”这两个字的碎片。你只能看到局部，拼凑不出整个案情。
- **痛点**：
  - **跨文档推理缺失**：线索 A 在第一章，线索 B 在第十章，单独检索很难把它们关联起来。
  - **全局概览缺失**：面对“总结全书人物关系”这种宏观问题，传统 RAG 只能捞几个片段，无法生成全局综述。

---

## 2. GraphRAG 是什么？（Structure is Key）

GraphRAG（由微软研究院提出）的核心思想是：**先用 LLM 把文本变成知识图谱（Knowledge Graph），再在图谱上做检索。**

### 第一步：图谱构建（Indexing Phase）

LLM 阅读所有文档，提取出：

- **实体（Entities）**：人名、地名、组织、概念。
- **关系（Relationships）**：A 是 B 的父亲，C 投资了 D。
- **社区（Communities）**：利用图算法（如 Leiden 算法）将紧密联系的实体聚类成一个个“社区”。

### 第二步：图谱检索（Query Phase）

当用户提问时，GraphRAG 不再是简单的向量匹配，而是：

- **局部搜索（Local Search）**：从相关实体出发，沿着关系边走两步，找到它的邻居。适合回答“A 的关系网是怎样的？”
- **全局搜索（Global Search）**：利用预先生成的“社区摘要（Community Summaries）”来回答宏观问题。适合回答“这就数据主要讲了什么趋势？”

---

## 3. GraphRAG 强在哪里？又有什么代价？

### (1) 连接隐形关系（Multi-hop Reasoning）

- **问题**：“Steve Jobs 和 Pixar 有什么关系？”
- **传统 RAG**：可能只搜到 Jobs 在 Apple，Pixar 做动画，关联不起来。
- **GraphRAG**：在图谱中，`Steve Jobs` -> `投资` -> `Pixar`，这条路径是显式的。它能顺藤摸瓜，找到深层联系。

### (2) 宏观归纳（Global Summarization）

- **问题**：“这份 10 万字的财报里，主要有哪些风险点？”
- **传统 RAG**：捞出 Top-5 个含“风险”的句子，以此管中窥豹，极其片面。
- **GraphRAG**：它已经预先对所有“风险社区”生成了摘要，能直接把这些摘要聚合起来，给你一个上帝视角的全面总结。

### (3) 代价：贵且慢（2025 的新挑战）

微软原始的 GraphRAG 方案构建图谱极其昂贵（Token 消耗巨大）。

- **2025 新趋势**：**LightRAG** 和 **Hybrid GraphRAG**。
- **LightRAG**：只构建核心实体关系，不搞全量图谱，大幅降低成本。
- **Hybrid 模式**：**“平时用向量（快），复杂问题切图谱（准）”**，在成本与效果之间寻找平衡。

---

## 4. 总结：RAG 的未来是“图文并茂”

GraphRAG 不是要取代向量检索，而是**降维打击**。

- 对于简单的事实查证（Fact Checking），向量检索够快够便宜。
- 对于复杂的**逻辑推理**和**全局洞察**，GraphRAG 是目前唯一的解法。

它标志着 RAG 从**“概率连接”**（向量相似度）走向了**“逻辑连接”**（图谱拓扑结构）。
